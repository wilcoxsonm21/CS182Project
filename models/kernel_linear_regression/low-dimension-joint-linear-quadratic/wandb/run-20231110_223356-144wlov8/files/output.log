


























































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































loss 4.196479320526123: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 500001/500001 [12:43:25<00:00, 10.92it/s]
  0%|                                                                                                                        | 0/1 [00:00<?, ?it/s]
{'standard': {'task_name': 'kernel_linear_regression', 'n_dims': 5, 'n_points': 21, 'batch_size': 64, 'data_name': 'gaussian', 'prompting_strategy': 'standard'}}
TransformerModel(
  (_read_in): Linear(in_features=5, out_features=256, bias=True)
  (_backbone): GPT2Model(
    (wte): Embedding(50257, 256)
    (wpe): Embedding(42, 256)
    (drop): Dropout(p=0.0, inplace=False)
    (h): ModuleList(
      (0): GPT2Block(
        (ln_1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
        (attn): GPT2Attention(
          (c_attn): Conv1D()
          (c_proj): Conv1D()
          (attn_dropout): Dropout(p=0.0, inplace=False)
          (resid_dropout): Dropout(p=0.0, inplace=False)
        )
        (ln_2): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
        (mlp): GPT2MLP(
          (c_fc): Conv1D()
          (c_proj): Conv1D()
          (act): NewGELUActivation()
          (dropout): Dropout(p=0.0, inplace=False)
        )
      )
      (1): GPT2Block(
        (ln_1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
        (attn): GPT2Attention(
          (c_attn): Conv1D()
          (c_proj): Conv1D()
          (attn_dropout): Dropout(p=0.0, inplace=False)
          (resid_dropout): Dropout(p=0.0, inplace=False)
        )
        (ln_2): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
        (mlp): GPT2MLP(
          (c_fc): Conv1D()
          (c_proj): Conv1D()
          (act): NewGELUActivation()
          (dropout): Dropout(p=0.0, inplace=False)
        )
      )
      (2): GPT2Block(
        (ln_1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
        (attn): GPT2Attention(
          (c_attn): Conv1D()
          (c_proj): Conv1D()
          (attn_dropout): Dropout(p=0.0, inplace=False)
          (resid_dropout): Dropout(p=0.0, inplace=False)
        )
        (ln_2): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
        (mlp): GPT2MLP(
          (c_fc): Conv1D()
          (c_proj): Conv1D()
          (act): NewGELUActivation()
          (dropout): Dropout(p=0.0, inplace=False)
        )
      )
      (3): GPT2Block(
        (ln_1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
        (attn): GPT2Attention(
          (c_attn): Conv1D()
          (c_proj): Conv1D()
          (attn_dropout): Dropout(p=0.0, inplace=False)
          (resid_dropout): Dropout(p=0.0, inplace=False)
        )
        (ln_2): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
        (mlp): GPT2MLP(
          (c_fc): Conv1D()
          (c_proj): Conv1D()
          (act): NewGELUActivation()
          (dropout): Dropout(p=0.0, inplace=False)
        )
      )
      (4): GPT2Block(
        (ln_1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
        (attn): GPT2Attention(
          (c_attn): Conv1D()
          (c_proj): Conv1D()
          (attn_dropout): Dropout(p=0.0, inplace=False)
          (resid_dropout): Dropout(p=0.0, inplace=False)
        )
        (ln_2): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
        (mlp): GPT2MLP(
          (c_fc): Conv1D()
          (c_proj): Conv1D()
          (act): NewGELUActivation()
          (dropout): Dropout(p=0.0, inplace=False)
        )
      )
      (5): GPT2Block(
        (ln_1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
        (attn): GPT2Attention(
          (c_attn): Conv1D()
          (c_proj): Conv1D()
          (attn_dropout): Dropout(p=0.0, inplace=False)
          (resid_dropout): Dropout(p=0.0, inplace=False)
        )
        (ln_2): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
        (mlp): GPT2MLP(
          (c_fc): Conv1D()
          (c_proj): Conv1D()
          (act): NewGELUActivation()
          (dropout): Dropout(p=0.0, inplace=False)
        )
      )
      (6): GPT2Block(
        (ln_1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
        (attn): GPT2Attention(
          (c_attn): Conv1D()
          (c_proj): Conv1D()
          (attn_dropout): Dropout(p=0.0, inplace=False)
          (resid_dropout): Dropout(p=0.0, inplace=False)
        )
        (ln_2): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
        (mlp): GPT2MLP(
          (c_fc): Conv1D()
          (c_proj): Conv1D()
          (act): NewGELUActivation()
          (dropout): Dropout(p=0.0, inplace=False)
        )
      )
      (7): GPT2Block(
        (ln_1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
        (attn): GPT2Attention(
          (c_attn): Conv1D()
          (c_proj): Conv1D()
          (attn_dropout): Dropout(p=0.0, inplace=False)
          (resid_dropout): Dropout(p=0.0, inplace=False)
        )
        (ln_2): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
        (mlp): GPT2MLP(
          (c_fc): Conv1D()
          (c_proj): Conv1D()
          (act): NewGELUActivation()
          (dropout): Dropout(p=0.0, inplace=False)
        )
      )
      (8): GPT2Block(
        (ln_1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
        (attn): GPT2Attention(
          (c_attn): Conv1D()
          (c_proj): Conv1D()
          (attn_dropout): Dropout(p=0.0, inplace=False)
          (resid_dropout): Dropout(p=0.0, inplace=False)
        )
        (ln_2): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
        (mlp): GPT2MLP(
          (c_fc): Conv1D()
          (c_proj): Conv1D()
          (act): NewGELUActivation()
          (dropout): Dropout(p=0.0, inplace=False)
        )
      )
      (9): GPT2Block(
        (ln_1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
        (attn): GPT2Attention(
          (c_attn): Conv1D()
          (c_proj): Conv1D()
          (attn_dropout): Dropout(p=0.0, inplace=False)
          (resid_dropout): Dropout(p=0.0, inplace=False)
        )
        (ln_2): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
        (mlp): GPT2MLP(
          (c_fc): Conv1D()
          (c_proj): Conv1D()
          (act): NewGELUActivation()
          (dropout): Dropout(p=0.0, inplace=False)
        )
      )
      (10): GPT2Block(
        (ln_1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
        (attn): GPT2Attention(
          (c_attn): Conv1D()
          (c_proj): Conv1D()
          (attn_dropout): Dropout(p=0.0, inplace=False)
          (resid_dropout): Dropout(p=0.0, inplace=False)
        )
        (ln_2): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
        (mlp): GPT2MLP(
          (c_fc): Conv1D()
          (c_proj): Conv1D()
          (act): NewGELUActivation()
          (dropout): Dropout(p=0.0, inplace=False)
        )
      )
      (11): GPT2Block(
        (ln_1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
        (attn): GPT2Attention(
          (c_attn): Conv1D()
          (c_proj): Conv1D()
          (attn_dropout): Dropout(p=0.0, inplace=False)
          (resid_dropout): Dropout(p=0.0, inplace=False)
        )
        (ln_2): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
        (mlp): GPT2MLP(
          (c_fc): Conv1D()
          (c_proj): Conv1D()
          (act): NewGELUActivation()
          (dropout): Dropout(p=0.0, inplace=False)
        )
      )
    )
    (ln_f): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
  )
  (_read_out): Linear(in_features=256, out_features=1, bias=True)
)
kernel_linear_regression
<models.KernelLeastSquaresModel object at 0x7fa3bff93eb0>

100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.47s/it]
<models.LeastSquaresModel object at 0x7fa36fff2070>
kernel_linear_regression
<models.NNModel object at 0x7fa36fff2ee0>
kernel_linear_regression
<models.AveragingModel object at 0x7fa36fff2fa0>
kernel_linear_regression
{'standard': {'gpt2_embd=256_layer=12_head=8': {'mean': [4.9338884353637695, 4.753859519958496, 3.9839580059051514, 2.5827908515930176, 1.814313292503357, 0.9607477188110352, 0.30906835198402405, 0.1327069103717804, 0.05405449867248535, 0.042069993913173676, 0.025923579931259155, 0.016718391329050064, 0.012407686561346054, 0.011845472268760204, 0.010081293061375618, 0.009595861658453941, 0.008992170915007591, 0.0081092594191432, 0.008194422349333763, 0.007592679467052221, 0.007410482969135046], 'std': [8.738508224487305, 9.55643081665039, 9.671171188354492, 7.0074238777160645, 5.40184211730957, 5.335301399230957, 2.1730260848999023, 0.9594658613204956, 0.384808748960495, 0.41054028272628784, 0.18869301676750183, 0.06903085112571716, 0.033875394612550735, 0.02748502790927887, 0.022105127573013306, 0.0243816040456295, 0.020593158900737762, 0.014315825887024403, 0.014722309075295925, 0.013323708437383175, 0.012387479655444622], 'bootstrap_low': [4.543991565704346, 4.333095073699951, 3.5652401447296143, 2.268134593963623, 1.5774914026260376, 0.7378551363945007, 0.22240892052650452, 0.09242234379053116, 0.03826140612363815, 0.026760021224617958, 0.018213098868727684, 0.013788213953375816, 0.010966816917061806, 0.010542084462940693, 0.009148025885224342, 0.008531537838280201, 0.008038608357310295, 0.007489921059459448, 0.007522209081798792, 0.006986026652157307, 0.006840189453214407], 'bootstrap_high': [5.373167514801025, 5.183268070220947, 4.425506591796875, 2.9080238342285156, 2.0614354610443115, 1.248244047164917, 0.4234979748725891, 0.1792745739221573, 0.07271458953619003, 0.06483513861894608, 0.035426121205091476, 0.019959090277552605, 0.01406542956829071, 0.01322232373058796, 0.011177221313118935, 0.010718101635575294, 0.009987224824726582, 0.008807488717138767, 0.008885604329407215, 0.00826321355998516, 0.008011777885258198]}, 'kernel_2_driver=None': {'mean': [4.434196472167969, 5.444604396820068, 4.929124355316162, 4.527046203613281, 3.893200635910034, 3.4018397331237793, 3.2379989624023438, 2.004774570465088, 1.6949512958526611, 0.968561053276062, 9.118797938967305e-10, 1.058117655994284e-11, 7.399215788683744e-12, 1.2489051676514706e-12, 8.518739641645567e-13, 7.606857851949478e-13, 7.534326352913456e-13, 6.487137758394435e-13, 5.120033086739029e-13, 4.104519729739714e-13, 3.938393936062795e-13], 'std': [7.291025161743164, 11.074166297912598, 10.518138885498047, 11.031839370727539, 9.742396354675293, 8.197776794433594, 8.6736421585083, 5.938181400299072, 6.412736415863037, 6.671363353729248, 1.853478082125548e-08, 7.681694863537203e-11, 1.7256013284949745e-10, 4.413245810463984e-12, 3.5348026589110404e-12, 2.930365368761234e-12, 7.909499444291868e-12, 5.51976086365924e-12, 2.9380842377080274e-12, 1.19429097687751e-12, 1.1905105807424876e-12], 'bootstrap_low': [4.112026691436768, 4.935925483703613, 4.4291605949401855, 4.0007734298706055, 3.4653213024139404, 3.0550506114959717, 2.8390896320343018, 1.7619476318359375, 1.432507872581482, 0.6990505456924438, 2.9775409915444584e-10, 7.423501049985681e-12, 2.1697294568662207e-12, 1.0596243934374305e-12, 7.046215282253965e-13, 6.309345949341572e-13, 4.96202742523294e-13, 4.55832366210579e-13, 3.980273955480479e-13, 3.6093030690922956e-13, 3.4505593369572873e-13], 'bootstrap_high': [4.787356376647949, 5.982004642486572, 5.473748683929443, 5.0783772468566895, 4.352093696594238, 3.8091800212860107, 3.6313273906707764, 2.2756237983703613, 2.0016350746154785, 1.3105261325836182, 1.947842553917667e-09, 1.4041330598235646e-11, 1.6863593854665737e-11, 1.4587752663816622e-12, 1.0285248130612046e-12, 9.046192614436954e-13, 1.179803108507238e-12, 9.514330512674918e-13, 6.598683188405174e-13, 4.665642872048181e-13, 4.5111749622309127e-13]}, 'OLS_driver=None': {'mean': [4.993899345397949, 3.9279167652130127, 2.9195809364318848, 1.9828612804412842, 1.013350248336792, 1.3264792819711602e-08, 3.749918344592151e-12, 4.698681222749246e-13, 4.01997499958201e-13, 3.03960578495327e-13, 2.68140544490425e-13, 2.2771912936044025e-13, 2.5127680968947685e-13, 1.9861850608215298e-13, 2.4684730171378733e-13, 2.1265862606024283e-13, 1.7733163299327864e-13, 1.9944141553106948e-13, 2.096037373614662e-13, 1.8417328751484108e-13, 1.8978521282731614e-13], 'std': [8.75001049041748, 7.173316955566406, 5.791840076446533, 4.42866325378418, 2.7079219818115234, 4.7118510337895714e-07, 8.874413010007132e-11, 1.347568649549824e-12, 1.0828900710163625e-12, 8.517094906949907e-13, 7.906691252244913e-13, 5.356437407337544e-13, 7.677586864873742e-13, 4.78074936409445e-13, 6.442734800521377e-13, 5.767404240818175e-13, 4.282136982242807e-13, 4.989277762636191e-13, 4.861237822874342e-13, 4.65766422826086e-13, 4.314011441911708e-13], 'bootstrap_low': [4.606818199157715, 3.6078007221221924, 2.677724599838257, 1.7874107360839844, 0.8935585021972656, 5.399238348080537e-11, 1.0675841721069501e-12, 4.093324529157172e-13, 3.5285701227225075e-13, 2.670185307671741e-13, 2.352616799289331e-13, 2.0473831234980172e-13, 2.1569374162189875e-13, 1.7647572314073712e-13, 2.1809623876843653e-13, 1.8748895394115478e-13, 1.5749353860991522e-13, 1.777408922083376e-13, 1.877758744935759e-13, 1.6470661369071687e-13, 1.6963553229210754e-13], 'bootstrap_high': [5.41839599609375, 4.260134696960449, 3.1759769916534424, 2.189225196838379, 1.1408284902572632, 3.96109456346494e-08, 8.662618365684605e-12, 5.349088142911351e-13, 4.527904201752364e-13, 3.44174911010367e-13, 3.0433457403472586e-13, 2.5409839163326176e-13, 2.8658556105488897e-13, 2.2200821638961726e-13, 2.7777332842725266e-13, 2.407443005798121e-13, 1.9818894518141422e-13, 2.2497837468861415e-13, 2.322621261985347e-13, 2.0488862342848968e-13, 2.1045531040531779e-13]}, 'NN_n=3_uniform': {'mean': [4.5918378829956055, 9.189115524291992, 7.587224006652832, 6.889626979827881, 5.433060646057129, 4.125914096832275, 4.010471343994141, 3.6642074584960938, 3.6098275184631348, 3.6054885387420654, 3.4292798042297363, 2.538888692855835, 2.907076358795166, 2.6025805473327637, 2.5102851390838623, 2.6468605995178223, 2.350632905960083, 2.351624011993408, 2.328989028930664, 2.2729732990264893, 2.2862496376037598], 'std': [8.35164737701416, 15.494568824768066, 12.768237113952637, 12.71587085723877, 9.49905776977539, 7.505859375, 8.255577087402344, 7.45218563079834, 7.333813667297363, 6.993274688720703, 8.183130264282227, 4.498649597167969, 5.8144145011901855, 4.607554912567139, 5.1496663093566895, 5.192193508148193, 4.2201828956604, 4.463716983795166, 4.920024871826172, 5.026020526885986, 4.49232292175293], 'bootstrap_low': [4.202954292297363, 8.53235149383545, 7.048108100891113, 6.288621425628662, 4.989541053771973, 3.773069381713867, 3.6338095664978027, 3.321617841720581, 3.2595372200012207, 3.2653706073760986, 3.098449468612671, 2.32706880569458, 2.655709743499756, 2.391786813735962, 2.2633888721466064, 2.417424201965332, 2.1510584354400635, 2.1499226093292236, 2.12095308303833, 2.0624208450317383, 2.0836257934570312], 'bootstrap_high': [4.975184440612793, 9.921931266784668, 8.16303825378418, 7.519108772277832, 5.882840633392334, 4.4536237716674805, 4.372529983520508, 4.042049407958984, 3.970057725906372, 3.9339561462402344, 3.8699538707733154, 2.748497486114502, 3.182837724685669, 2.8380343914031982, 2.747809886932373, 2.908867597579956, 2.554879665374756, 2.563077211380005, 2.5722992420196533, 2.5130362510681152, 2.5207505226135254]}, 'averaging': {'mean': [5.005947589874268, 32.0661735534668, 14.813901901245117, 9.904924392700195, 7.97727108001709, 6.314174652099609, 5.915244102478027, 4.484169960021973, 4.3073883056640625, 3.347789764404297, 3.493607997894287, 3.0215771198272705, 2.8837265968322754, 2.259730100631714, 2.2447078227996826, 2.121454954147339, 1.987691879272461, 1.7229602336883545, 1.8595174551010132, 1.5310736894607544, 1.6161906719207764], 'std': [8.729660987854004, 121.1123275756836, 57.947078704833984, 27.583066940307617, 21.296676635742188, 17.54792594909668, 16.83551597595215, 12.09205150604248, 14.640284538269043, 9.210989952087402, 12.123727798461914, 8.151930809020996, 6.653998851776123, 4.665541648864746, 4.853861331939697, 5.6225972175598145, 4.987786293029785, 3.612248420715332, 6.077511310577393, 3.0096280574798584, 3.339775562286377], 'bootstrap_low': [4.614624977111816, 26.90725326538086, 12.37807559967041, 8.728784561157227, 7.010870456695557, 5.528059482574463, 5.183626651763916, 3.9267196655273438, 3.640019655227661, 2.9358787536621094, 2.9776227474212646, 2.691945791244507, 2.5912718772888184, 2.0483341217041016, 2.022660970687866, 1.8663742542266846, 1.7670282125473022, 1.5643408298492432, 1.5974414348602295, 1.4012885093688965, 1.466422438621521], 'bootstrap_high': [5.388193607330322, 38.067359924316406, 17.554195404052734, 11.177955627441406, 9.014140129089355, 7.095919132232666, 6.664959907531738, 5.02059268951416, 5.05009651184082, 3.8106703758239746, 4.134134769439697, 3.4084434509277344, 3.1957950592041016, 2.467580795288086, 2.457907199859619, 2.3899807929992676, 2.206190824508667, 1.8792860507965088, 2.184962511062622, 1.6623284816741943, 1.7738978862762451]}}}